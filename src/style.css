/* =========================================================
   Theme tokens (Dark is default; Light overrides below)
   ========================================================= */
:root{
  --bg: #0f1115;
  --panel: #151821;
  --panel-2: #0f1117;
  --text: #e6e9ef;
  --muted: #99a1b3;
  --brand: #3b63ff;
  --accent: #4dd4a7;
  --danger: #ff6b6b;
  --border: #23283a;
  --shadow: 0 10px 30px rgba(0,0,0,.35);
  --radius: 12px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  --sans: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;

  --editor-bg: #0d1018;
  --code-bg: #0b0f17;
  --blockquote-bg: #121728;
}

/* Light theme overrides */
html[data-theme="light"]{
  --bg: #f6f7fb;
  --panel: #ffffff;
  --panel-2: #f5f7fb;
  --text: #171923;
  --muted: #5f6b85;
  --brand: #3457ff;
  --accent: #2bb673;
  --danger: #e53935;
  --border: #d9deea;
  --shadow: 0 10px 30px rgba(21, 27, 61, .08);

  --editor-bg: #ffffff;
  --code-bg: #f2f4fb;
  --blockquote-bg: #eef2ff;
}

/* Smooth-ish theme transitions */
* { box-sizing: border-box; }
html, body { height: 100%; }
body{
  margin:0;
  background: radial-gradient(1200px 600px at 20% -10%, #1a2030 0%, var(--bg) 60%);
  color: var(--text);
  font-family: var(--sans);
  line-height: 1.45;
  transition: background .25s ease, color .2s ease;
}

/* Header */
.app-header{
  display:flex; align-items:center; justify-content:space-between;
  padding: 12px 16px;
  background: linear-gradient(180deg, rgba(255,255,255,.02), transparent);
  border-bottom: 1px solid var(--border);
}
.brand { display:flex; align-items:center; gap:.6rem; }
.brand .logo{ filter: drop-shadow(0 2px 6px rgba(124,156,255,.25)); }
.muted{ color: var(--muted); font-weight: 500; }

.actions{ display:flex; align-items:center; gap:.5rem; }
.actions button, .btn-like, label.btn-like{
  background: linear-gradient(180deg, var(--panel), var(--panel-2));
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px 12px;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: var(--shadow);
  font-weight: 600;
  transition: background .2s ease, color .2s ease, border-color .2s ease;
}
.actions button:hover, .btn-like:hover{ outline: 1px solid rgba(60,80,140,.4); }
.actions .divider{
  width:1px; height:26px; background: var(--border); margin: 0 4px;
}
.status{ color: var(--muted); margin-left:.5rem; min-width: 140px; text-align:right; }

/* Theme button label tweak */
.btn-theme{ min-width: 100px; text-align: left; }

/* Layout */
.layout{
  height: calc(100vh - 112px);
  display:grid;
  grid-template-columns: 260px 1fr 1fr;
  gap: 10px;
  padding: 10px;
}

.panel{
  background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
  min-height: 0; /* allow child to scroll */
}

/* Files panel */
.panel.files{ display:flex; flex-direction:column; }
.panel-header{ padding:10px; border-bottom:1px solid var(--border); }
.search{
  width:100%; padding:8px 10px; border-radius:8px; border:1px solid var(--border);
  background: var(--panel-2); color: var(--text);
}

/* File list */
.file-list{ list-style:none; margin:0; padding:6px; overflow:auto; }
.file-item{
  display:flex; align-items:center; justify-content:space-between;
  gap:.4rem; padding:10px 10px; border-radius:8px; cursor:pointer;
}
.file-item:hover{ background: color-mix(in oklab, var(--panel-2), black 6%); }
html[data-theme="light"] .file-item:hover{ background: color-mix(in oklab, var(--panel-2), black 2%); }
.file-item.active{
  background: linear-gradient(180deg, color-mix(in oklab, var(--brand), transparent 82%), color-mix(in oklab, var(--brand), transparent 92%));
  border:1px solid color-mix(in oklab, var(--brand), transparent 70%);
}
.file-item .title{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; flex:1; }
.file-item .meta{ color: var(--muted); font-size:.78rem; }

/* Editor */
.panel.editor{ display:flex; }
#editor{
  width:100%; resize:none; border:0; outline:0; flex:1;
  padding:16px; font-family: var(--mono); font-size: 15px;
  background: var(--editor-bg); color: var(--text);
  transition: background .2s ease, color .2s ease, border-color .2s ease;
}

/* Preview */
.panel.preview{ overflow:auto; }
.preview-content{
  padding: 20px 24px 60px;
  max-width: 900px;
}
.preview-content h1,h2,h3{ margin-top: 1.2em; }
.preview-content pre{
  background: var(--code-bg); border:1px solid var(--border);
  padding:14px; border-radius:10px; overflow:auto;
  transition: background .2s ease, color .2s ease, border-color .2s ease;
}
.preview-content code{
  font-family: var(--mono);
  background: var(--code-bg); border:1px solid var(--border);
  padding:2px 5px; border-radius:6px;
}
.preview-content pre code{
  background:none; border:0; padding:0;
}
.preview-content blockquote{
  border-left:4px solid var(--brand);
  margin:0; padding:.5rem 1rem; background: var(--blockquote-bg); border-radius:6px;
  color: color-mix(in oklab, var(--text), var(--muted) 30%);
}
.preview-content a{ color: var(--brand); text-decoration: none; }
.preview-content a:hover{ text-decoration: underline; }
.preview-content hr{
  border:0; border-top:1px solid var(--border); margin: 1.4rem 0;
}
.preview-content table{
  border-collapse: collapse; width:100%; margin:1rem 0; font-size:.95rem;
}
.preview-content th, .preview-content td{
  border:1px solid var(--border); padding:.5rem .6rem;
}
.preview-content tr:nth-child(even){ background: color-mix(in oklab, var(--panel-2), white 0%); }
html[data-theme="light"] .preview-content tr:nth-child(even){ background: #f8faff; }
.preview-content img{ max-width:100%; border-radius:8px; border:1px solid var(--border); }

/* Footer */
.app-footer{
  display:flex; align-items:center; justify-content:space-between;
  gap: 12px;
  padding: 12px 16px;
  background: linear-gradient(180deg, transparent, rgba(255,255,255,.02));
  border-top: 1px solid var(--border);
  color: var(--text);
  font-size: .95rem;
}
.app-footer .muted{ color: var(--muted); }
.footer-left, .footer-center, .footer-right{
  display:flex; align-items:center; gap:.5rem; min-width:0;
}
.footer-center{
  justify-content:center; margin: 0 auto; text-align:center;
}
.dot{
  width:8px; height:8px; border-radius:50%;
  background: var(--accent);
  box-shadow: 0 0 10px var(--accent);
  display:inline-block;
  animation: pulse 2.2s ease-in-out infinite;
}
@keyframes pulse{
  0%,100% { transform: scale(1); opacity: .9; }
  50%    { transform: scale(1.25); opacity: .6; }
}

/* Modal (Export) */
.modal{
  position: fixed; inset: 0; display: none;
  align-items: center; justify-content: center;
  background: rgba(0,0,0,.45); z-index: 1000;
}
.modal[aria-hidden="false"]{ display: flex; }
.modal-content{
  width: min(720px, 92vw);
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow);
  padding: 16px;
}
.modal-content h3{ margin: 0 0 8px 0; }
.export-list{
  max-height: 45vh; overflow: auto;
  border: 1px solid var(--border);
  border-radius: 10px; padding: 6px;
  background: var(--panel-2); margin-top: 8px;
}
.export-item{
  display:flex; align-items:center; gap:.6rem;
  padding: 8px 8px; border-radius: 8px; cursor: pointer;
}
.export-item:hover{ background: color-mix(in oklab, var(--panel-2), black 4%); }
html[data-theme="light"] .export-item:hover{ background: #f2f5ff; }
.export-item input{ margin: 0; }
.export-item .title{ flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.export-item .meta{ color: var(--muted); font-size: .82rem; }
.modal-actions{
  display:flex; align-items:center; gap:.6rem; margin-top: 12px;
}
.modal-actions .spacer{ flex: 1; }
.btn-ghost{
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
}
.select-all{ display:flex; align-items:center; gap:.5rem; }

/* Misc */
kbd{
  font-family: var(--mono);
  background: color-mix(in oklab, var(--panel-2), black 6%);
  border:1px solid var(--border); border-bottom-color: color-mix(in oklab, var(--border), black 12%);
  border-radius:6px; padding:0 6px;
  box-shadow: inset 0 -2px 0 color-mix(in oklab, var(--border), black 12%);
}

/* Responsive */
@media (max-width: 1100px){
  .layout{ grid-template-columns: 240px 1fr; }
  .panel.preview{ grid-column: 1 / -1; }
}
@media (max-width: 760px){
  .layout{ grid-template-columns: 1fr; }
  .panel.files{ order: -1; }
  .app-header .muted{ display:none; }
  .app-footer{ flex-direction:column; text-align:center; }
  .footer-center{ margin: 0; }
}
